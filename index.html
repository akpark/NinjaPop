<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ninja Pop</title>
    <link rel="stylesheet" type="text/css" href="assets/canvas.css">
  </head>
  <body>
    <div id="header">
      <h1>Ninja Pop<h1>
      <h3>Shoot all the bubbles before the timer runs out!</h3>
      <h3>> LEFT / RIGHT to dodge bubbles</h3>
      <h3>> SPACEBAR to shoot shurikens</h3>
    </div>
    <div id="canvas-wrap">
      <canvas id="canvas-game"></canvas>
      <div id="welcome-screen">
        <div id="character-choice-text">Choose Your Character!</div>
        <table id="character-table">
          <tr>
            <td class="character-link" value=0 ><img class="ninja-black" src="assets/images/sprites/ninja/ninja-black-icon.png"/></td>
            <td class="character-link" value=1 ><img class="ninja-grey" src="assets/images/sprites/ninja/ninja-red-icon.png"/></td>
            <td class="character-link" value=2 ><img class="ninja-red" src="assets/images/sprites/ninja/ninja-grey-icon.png"/></td>
          </tr>
        </table>
        <div class="display-character-outer">
          <div class="display-character"></div>
        </div>
        <div id="start-game-outer">
          <div id="start-game">Start!</div>
        </div>
      </div>
      <div id="center-message"></div>
    </div>
    <div id="toggle-music-outer">
      <div id="toggle-music">Toggle Music On/Off</div>
    </div>

    <script type="application/javascript" src="http://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script type="application/javascript" src="lib/bubble.js"></script>
    <script type="application/javascript" src="lib/attack.js"></script>
    <script type="application/javascript" src="lib/pop.js"></script>
    <script type="application/javascript" src="lib/ceiling.js"></script>
    <script type="application/javascript" src="lib/footer.js"></script>
    <script type="application/javascript" src="lib/ninja.js"></script>
    <script type="application/javascript" src="lib/gameView.js"></script>
    <script type="application/javascript" src="lib/game.js"></script>

    <script type="application/javascript">
      (function () {
        var canvasEl = document.getElementsByTagName("canvas")[0];
        canvasEl.width = NinjaPop.Game.DIM_X;
        canvasEl.height = NinjaPop.Game.DIM_Y;

        $(document).ready(function () {

          var myAudio = new Audio('assets/sounds/loop.wav');
          myAudio.volume = 0.1;
          myAudio.addEventListener('ended', function() {
            this.currentTime = 0;
            this.play();
          }, false);
          var introAudio = new Audio('assets/sounds/oriental-intro.mp3');
          introAudio.play();

          $(".character-link").on("click", function (e) {
            $(".character-link").removeClass("selected");
            $(e.currentTarget).addClass("selected");
            //change the display character
            $(".display-character").attr("class", "display-character");
            switch (parseInt($(e.currentTarget).attr("value"))) {
              case 0:
                $(".display-character").addClass("black-ninja");
                break;
              case 1:
                $(".display-character").addClass("red-ninja");
                break;
              case 2:
                $(".display-character").addClass("grey-ninja");
                break;
            }
          });

          $("#toggle-music").click(function () {
            if (myAudio.paused) {
              myAudio.play();
            } else {
              myAudio.pause();
            }
          });

          $("#start-game").click(function () {
            $('#welcome-screen').hide();
            var ctx = canvasEl.getContext("2d");
            var game = new NinjaPop.Game(1, ctx);
            var kabuki = new Audio("assets/sounds/kabuki.wav");
            kabuki.play();
            new NinjaPop.GameView(game, ctx).start();
            myAudio.play();
          });
        })
      })();
    </script>

  </body>
</html>
